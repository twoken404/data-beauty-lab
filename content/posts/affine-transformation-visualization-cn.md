---
title: "平面仿射变换的可视化：用Python探索几何变换之美"
date: 2025-12-23
slug: "affine-transformation-visualization-zh"
categories: ["数据可视化", "线性代数"]
tags: ["Python", "Matplotlib", "线性变换", "仿射变换", "可视化"]
draft: false
---

### 什么是平面仿射变换？

平面仿射变换是几何学中的一个核心概念，它描述了一种保持直线和平行关系的变换。简单来说，就是对平面上的点进行旋转、缩放、剪切等操作的组合，且变换后直线仍然是直线，平行线仍然平行。在计算机图形学、图像处理和机器学习中，这个概念无处不在。

本文将通过一系列生动的Python可视化案例，带你直观理解仿射变换的几种基本类型。

### 准备工作：网格与可视化函数

首先，我们创建一个坐标网格作为变换的“画布”，并定义一个通用的可视化函数。

```python
import numpy as np
import matplotlib.pyplot as plt

# 生成网格数据
x1 = np.arange(-20, 20 + 1, step=1)
x2 = np.arange(-20, 20 + 1, step=1)
XX1, XX2 = np.meshgrid(x1, x2)

# 自定义可视化函数
def visualize_transform(XX1, XX2, ZZ1, ZZ2, cube, arrows, fig_name):
    # ... (具体实现代码见原文)
    # 该函数会绘制原始网格（灰色）和变换后网格（蓝色），并高亮显示一个单位正方形和两个基向量。
```

### 案例一：旋转

旋转是绕某一点（通常是原点）转动一个角度。例如，逆时针旋转30度。

```python
import numpy as np
# 绕原点，逆时针旋转30度
theta = 30/180*np.pi
R = np.array([[np.cos(theta), -np.sin(theta)],
              [np.sin(theta),  np.cos(theta)]])
# 对网格点X应用旋转矩阵R
Z = X @ R.T
```
**效果**：整个网格和内部的单位正方形都绕原点旋转了30度，红色的x轴基向量和绿色的y轴基向量也一同旋转，但它们依然保持垂直。

### 案例二：缩放

缩放分为等比例缩放和非等比例缩放。
*   **等比例放大**：两个坐标轴方向按相同比例拉伸。
    ```python
    S = np.array([[2, 0],
                  [0, 2]])
    Z = X @ S
    ```
    **效果**：网格间距变大，单位正方形面积变为原来的4倍。
*   **等比例缩小**：两个坐标轴方向按相同比例压缩。
    ```python
    S = np.array([[0.4, 0],
                  [0,   0.4]])
    ```
    **效果**：网格间距变小，单位正方形面积缩小。
*   **非等比例缩放**：两个坐标轴方向的缩放比例不同。
    ```python
    S = np.array([[2, 0],
                  [0, 0.5]])
    ```
    **效果**：x轴方向被拉长，y轴方向被压扁。正方形变成了长方形，基向量长度也相应改变。

### 案例三：组合变换（缩放与旋转）

变换的顺序至关重要，因为矩阵乘法不满足交换律。
*   **先缩放，再旋转**
    ```python
    Z = X @ S.T @ R.T
    ```
    **效果**：先将网格拉伸/压扁，再将这个变形后的网格旋转。
*   **先旋转，再缩放**
    ```python
    Z = X @ R.T @ S.T
    ```
    **效果**：先旋转标准网格，再对旋转后的网格进行拉伸/压扁。最终结果与前者明显不同。

### 案例四：剪切

剪切是一种使图形发生“错切”变形的变换，例如沿横轴（x轴）剪切。
```python
T = np.array([[1, 1.5],
              [0,   1]])
Z = X @ T.T
```
**效果**：竖直的网格线发生了倾斜，但仍然是平行线。单位正方形变成了平行四边形，y轴基向量保持不变，而x轴基向量在y方向上增加了分量。

### 应用

通过以上案例，我们直观地看到了：
1.  **旋转矩阵** `R` 如何改变方向而保持形状。
2.  **缩放矩阵** `S` 如何改变大小，可以是均匀的也可以是非均匀的。
3.  **剪切矩阵** `T` 如何改变形状而保持面积（行列式为1时）。
4.  **矩阵乘法顺序**决定了复合变换的最终效果。

**实际应用场景**：
*   **图像处理**：对图像进行旋转、缩放、扭曲校正。
*   **计算机视觉**：在特征匹配和图像配准中，用仿射变换模型来对齐图像。
*   **数据增强**：在训练机器学习模型（尤其是计算机视觉模型）时，通过对训练图像进行随机的仿射变换来增加数据多样性，提升模型泛化能力。
*   **计算机图形学**：实现2D精灵（Sprite）的移动、旋转和缩放。

理解仿射变换及其矩阵表示，是深入这些领域的重要基石。